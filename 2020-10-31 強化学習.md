---
tags:
  - 強化学習
---

# 2020-10-31 強化学習

##　環境作り

- 仮想環境を作成
  本に習って、python3.6 の環境を作成する

  ```create_env
  conda create --name openai_gym python=3.6 anaconda
  ```

- openAI gym のインストール
  atari は windows では非公式、入れるためには、microsoft build tools 2015 が必要
  `https://www.microsoft.com/ja-JP/download/details.aspx?id=48159`から入れる

  ```pip
  activate openai_gym
  pip install gym
  pip install --no-index -f https://github.com/Kojoley/atari-py/releases atari_py
  ```

  ランダムに動かしてテスト ---> 無事に動いた

  ```test.py
  import gym
  env = gym.make("CartPole-v1")
  env.reset()
  while True:
  env.render()
  action = env.action_space.sample()
  state,reward,done,info = env.step(action)
  if done:
      break
  env.close()
  ```

- Stable Baselines のインストール
  windows にインストールする場合は、Microsoft MPI v10.0 が必要になるので、
  `https://www.microsoft.com/en-us/download/details.aspx?id=57467`から`msmpisetup.exe`をダウンロードしてインストール  
    ※exeでないと、上手くいかなかった。

    ```pip
    pip install stable-baselines[mpi]
    pip install tensorflow==1.14.0
    pip install pyqt5
    pip install imageio
    ```

    test ---> 無事に動いた

    ```test.py
    import gym
    from stable_baselines.common.vec_env import DummyVecEnv
    from stable_baselines import PPO2

    env = gym.make('CartPole-v1')
    env = DummyVecEnv([lambda: env])
    model = PPO2("MlpPolicy", env, verbose=1)
    model.learn(total_timesteps=10000)
    state = env.reset()

    for i in range(1000):
        env.render()
        action, _ = model.predict(state,deterministic=True)
        state, rewards, done, info = env.step(action)
        if done:
            break
    env.close()
    ```
